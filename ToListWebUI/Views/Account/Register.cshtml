@model ToDoListWebDomain.Domain.Models.UserRegistration;
@using ToListWebUI.HttpServisec;

<html>
    <head>
        <link rel="stylesheet" href="~/css/site.css" />
    </head>
    <body>
        <header class="main-header">
            <h1>Creating new account</h1>
        </header>
        
        <main class="main-content registration">
            <div class="editor account-form">
                <form id="registration-form">
                    @Html.AntiForgeryToken()

                    <div>
                        <label for="LoginProp">
                            Login:
                            <input type="text" id="LoginProp" name="LoginProp" class="text-input" required placeholder="Login" />
                        </label>

                    </div>

                    <div>
                        <label for="EmailProp">
                            Email:
                            <input type="text" id="EmailProp" name="EmailProp" class="text-input" required placeholder="Email" />
                        </label>

                    </div>

                    <div>
                        <label for="Password">
                            Password:
                            <input type="password" id="Password" name="Password" class="text-input" required placeholder="Password" />
                        </label>

                    </div>
                    <div>
                        <label for="ConfirmPassword">
                            Confirm password:
                            <input type="password" id="ConfirmPassword" name="ConfirmPassword" class="text-input" required placeholder="Confirm password" />
                        </label>

                    </div>
                    <button type="submit" class="submit">Register</button>
                </form>

            </div>
            @*Кнопка для того что б перейти к регестрации(На случай если нет аккаунта) знаю так делают просто*@
            <a class="button" href="@Url.Action("Login", "Account")">
                I have account already
            </a>
        </main>
    <script>
        console.log("Script loaded");

        document.addEventListener("DOMContentLoaded", function () {
            const registrationForm = document.getElementById("registration-form");

            registrationForm.addEventListener("submit", async function (event) {
                event.preventDefault(); // Отменить обычную отправку формы

                // Получить данные из формы
                const loginProp = document.getElementById("LoginProp").value;
                const emailProp = document.getElementById("EmailProp").value;
                const password = document.getElementById("Password").value;
                const confirmPassword = document.getElementById("ConfirmPassword").value;

                const userData = {
                    LoginProp: loginProp,
                    EmailProp: emailProp,
                    Password: password,
                    ConfirmPassword: confirmPassword
                };

                try {
                    // Отправить данные на сервер API
                    const response = await fetch("https://localhost:53807/api/APIAccount/RegisterAccount", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify(userData),
                    });

                    if (response.ok) {
                        // Регистрация успешна, выполните необходимые действия (например, перенаправление пользователя)
                        window.location.href = "/Home/Index"; // Замените на свой URL
                    } else {
                        // Регистрация не удалась, выполните необходимые действия (например, отображение ошибки)
                        alert("Ошибка при регистрации.");
                    }
                } catch (error) {
                    console.error("Ошибка при выполнении запроса:", error);
                    alert("Произошла ошибка при выполнении запроса.");
                }
            });
        });


    </script>

    
        
    </body>

</html>


